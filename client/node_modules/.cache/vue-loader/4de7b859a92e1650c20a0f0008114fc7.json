{"remainingRequest":"/Users/haris/Development/counting/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/haris/Development/counting/client/src/pages/face_recognition/FaceStreamDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/haris/Development/counting/client/src/pages/face_recognition/FaceStreamDetail.vue","mtime":1579493503435},{"path":"/Users/haris/Development/counting/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/haris/Development/counting/client/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/haris/Development/counting/client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/haris/Development/counting/client/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/Users/haris/Development/counting/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/haris/Development/counting/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBWdWVMb2FkSW1hZ2UgZnJvbSAndnVlLWxvYWQtaW1hZ2UnCgogIGV4cG9ydCBkZWZhdWx0IHsKICAgIGNvbXBvbmVudHM6IHsndnVlLWxvYWQtaW1hZ2UnOiBWdWVMb2FkSW1hZ2UgfSwKICAgIHByb3BzOiB7CiAgICAgIHNvdXJjZTogU3RyaW5nLAogICAgfSwKICAgIGRhdGE6ICgpID0+ICh7CiAgICAgICAgYWxlcnQgOiBmYWxzZSwKICAgICAgICBlcnJvcl90ZXh0OiAnJywKICAgICAgICBwYWdlOiAxLAogICAgICAgIGNoYXJ0SGlkZTogZmFsc2UsCgogICAgICAgIGlkX2NhbWVyYSA6ICcnLAogICAgICAgIHBvcnQ6ICcnLAogICAgICAgIGNhbWVyYV9saXN0OltdLAogICAgICAgIHZpZGVvRGVmYXVsdDogIkAvYXNzZXRzL2xvYWRpbmcuZ2lmIiwKCiAgICAgICAgZmFjZV9hbGwgOltdLAogICAgICAgIGZhY2VfaWRlbnRpdHkgOltdLAogICAgfSksCgogICAgY3JlYXRlZCAoKSB7CiAgICAgIHRoaXMuJFByb2dyZXNzLnN0YXJ0KCkKICAgICAgdGhpcy5pZF9jYW1lcmEgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQKICAgICAgdGhpcy5pbml0aWFsaXplKCkgICAgICAKICAgIH0sCiAgICAKICAgIG1vdW50ZWQoKXsKICAgICAgdGhpcy4kUHJvZ3Jlc3MuZmluaXNoKCkKICAgIH0sCgogICAgd2F0Y2g6IHsKICAgICAgICBpZF9jYW1lcmE6ZnVuY3Rpb24oKSB7CiAgICAgICAgICB0aGlzLiRzb2NrZXQuZW1pdCgnam9pbicsIHRoaXMuJHJvdXRlLnBhcmFtcy5pZCk7CiAgICAgICAgICB0aGlzLmdldERhdGEodGhpcy4kcm91dGUucGFyYW1zLmlkKQogICAgICAgIH0sCiAgICB9LAoKICAgIG1ldGhvZHM6IHsKICAgICAgICBhc3luYyBpbml0aWFsaXplICgpIHsKICAgICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgdGhpcy4kaHR0cC5nZXQocHJvY2Vzcy5lbnYuVlVFX0FQUF9JUF9TRVJWRVIgKyAnL2NhbWVyYScpCiAgICAgICAgICB0aGlzLmNhbWVyYV9saXN0ID0gZGF0YQogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGdldERhdGEoaWRfY2FtZXJhKXsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCB0aGlzLmF4aW9zLmdldChwcm9jZXNzLmVudi5WVUVfQVBQX0lQX1NFUlZFUiArICcvY2FtZXJhLycgKyBpZF9jYW1lcmEpCiAgICAgICAgICAgICAgdGhpcy5wb3J0ID0gZGF0YVsncG9ydCddCiAgICAgICAgICAgICAgdGhpcy5jaGVja0Nvbm5lY3Rpb24odGhpcy5wb3J0KQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKE9iamVjdC5rZXlzKGVycm9yKSwgZXJyb3IubWVzc2FnZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBjaGFuZ2VSb3V0ZSgpewogICAgICAgICAgdGhpcy4kc29ja2V0LmVtaXQoJ2xlYXZlJywgdGhpcy4kcm91dGUucGFyYW1zLmlkKTsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHtwYXRoOiAnL2xpdmUvJ30pCiAgICAgICAgICB0aGlzLmlkX2NhbWVyYSA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZAogICAgICAgIH0sCgogICAgICAgIGNoZWNrQ29ubmVjdGlvbihwb3J0KXsKICAgICAgICAgIGNvbnN0IF9zZWxmID0gdGhpcwogICAgICAgICAgdGhpcy5heGlvcy5nZXQocHJvY2Vzcy5lbnYuVlVFX0FQUF9JUF9TRVJWRVJfV0lUSE9VVF9QT1JUICsgJzonICsgcG9ydCkudGhlbihmdW5jdGlvbigpewogICAgICAgICAgICBfc2VsZi52aWRlb1N0cmVhbSgpCiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcil7CiAgICAgICAgICAgICAgaWYgKCFlcnJvci5yZXNwb25zZSkgewogICAgICAgICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKGVycm9yKQogICAgICAgICAgICAgICAgX3NlbGYuc3RyZWFtU3RhdHVzID0gZmFsc2UKICAgICAgICAgICAgICAgIF9zZWxmLmltYWdlTG9hZEVycm9yKCkKICAgICAgICAgICAgICAgIF9zZWxmLnRleHQgPSAiQ2FuJ3QgY29ubmVjdCB2aWRlbyBzdHJlYW0gISIKICAgICAgICAgICAgICAgIF9zZWxmLmNvbG9yX3NuYWNrYmFyID0gInJlZCBkYXJrZW4tMSIKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29uc3QgY29kZSA9IGVycm9yLnJlc3BvbnNlLnN0YXR1cwogICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBlcnJvci5yZXNwb25zZS5kYXRhCiAgICAgICAgICAgICAgICBfc2VsZi50ZXh0ID0gIkNhbid0IGNvbm5lY3QgdmlkZW8gc3RyZWFtICEgKCIgKyBjb2RlICsgIikgcmVzcG9uc2U6ICIgKyAgcmVzcG9uc2UKICAgICAgICAgICAgICAgIF9zZWxmLmNvbG9yX3NuYWNrYmFyID0gInllbGxvdyBkYXJrZW4tMSIKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX3NlbGYuc25hY2tiYXIgPSB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICB2aWRlb1N0cmVhbSgpewogICAgICAgICAgICBsZXQgcmFuZG9tID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDE1KSArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCAxNSkKICAgICAgICAgICAgdGhpcy52aWRlb0RlZmF1bHQgPSBwcm9jZXNzLmVudi5WVUVfQVBQX0lQX1NFUlZFUl9XSVRIT1VUX1BPUlQgKyAiOiIgKyB0aGlzLnBvcnQgKyAiLyIgKyByYW5kb20gKyAiL3N0cmVhbS5tanBnIgogICAgICAgIH0sCgogICAgICAgIGltYWdlTG9hZEVycm9yKCl7CiAgICAgICAgICAgIHRoaXMudmlkZW9EZWZhdWx0ID0gcmVxdWlyZSgnQC9hc3NldHMvb2ZmbGluZS5qcGcnKQogICAgICAgIH0sCgogICAgfSwKCiAgICBzb2NrZXRzOiB7CiAgICAgIGNvbm5lY3Q6IGZ1bmN0aW9uICgpewogICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKCdzb2NrZXQgY29ubmVjdGVkJykKICAgICAgfSwKICAgICAgZmFjZV9kZXRlY3Q6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICBpZiAodGhpcy5mYWNlX2FsbC5sZW5ndGggPT0gMTIpIHsKICAgICAgICAgICAgdGhpcy4kZGVsZXRlKHRoaXMuZmFjZV9hbGwsIDExKQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5mYWNlX2FsbC51bnNoaWZ0KGRhdGEpCgogICAgICAgICAgaWYgKGRhdGEubmFtZSAhPSAiVW5rbm93biIpIHsKICAgICAgICAgICAgdGhpcy5heGlvcy5nZXQoJ2h0dHA6Ly9sb2NhbGhvc3Q6ODAwMS9nZXRfZmFjZS8nICsgZGF0YS5uaWspLnRoZW4oCiAgICAgICAgICAgICAgcmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgaWYgKHRoaXMuZmFjZV9pZGVudGl0eS5sZW5ndGggPT0gMTIpIHsKICAgICAgICAgICAgICAgICAgdGhpcy4kZGVsZXRlKHRoaXMuZmFjZV9pZGVudGl0eSwgMTEpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkYXRhLnBob3RvID0gJ2RhdGE6aW1hZ2UvanBlZztiYXNlNjQsJyArIHJlc3BvbnNlLmRhdGEKICAgICAgICAgICAgICAgIHRoaXMuZmFjZV9pZGVudGl0eS51bnNoaWZ0KGRhdGEpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICApLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhlcnJvcikKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgYmVmb3JlRGVzdHJveTogZnVuY3Rpb24oKSB7CiAgICAgICAgdGhpcy4kc29ja2V0LmVtaXQoJ2xlYXZlJywgdGhpcy4kcm91dGUucGFyYW1zLmlkKTsKICAgIH0sCgogIH0K"},{"version":3,"sources":["FaceStreamDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkIA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA","file":"FaceStreamDetail.vue","sourceRoot":"src/pages/face_recognition","sourcesContent":["<template>\n    <v-row>\n      <v-col cols=\"12\" v-if=\"alert\">\n        <v-alert \n          class=\"mb-n4\"\n          v-model=\"alert\" \n          type=\"error\"\n          dense\n        >\n          {{ error_text }}\n        </v-alert>\n      </v-col>\n      <v-col\n        :cols=\"12\"\n        md=\"8\"\n      >\n        <v-card\n          class=\"pa-2\"\n          height=\"450\"\n          tile\n          outlined\n        >\n          <vue-load-image>\n            <img slot=\"image\" :src=\"videoDefault\" style=\"width: 100%\"/>\n            <v-img slot=\"preloader\" src=\"@/assets/preloader.gif\"/>\n            <v-img slot=\"error\" src=\"@/assets/offline.jpg\" aspect-ratio=\"1.7\"/>\n          </vue-load-image>\n        </v-card>\n      </v-col>\n\n      <v-col\n        :cols=\"12\"\n        md=\"4\"\n      >\n         <v-card\n          class=\"pa-2 overflow-y-auto\"\n          height=\"450\"\n          tile\n          outlined\n        >\n          <div v-if=\"face_identity.length == 0\">\n            <v-img src=\"@/assets/no_result.gif\"></v-img>\n          </div>\n          <div v-else>\n            <div class=\"overline \">Valid Identity Face</div>\n            <v-divider></v-divider>\n            <v-row \n              class=\"mb-n4\"\n              v-for=\"item in face_identity\"\n              :key=\"item.time\" \n              align=\"center\"\n              justify=\"center\"\n              >\n              <v-col cols=\"4\">\n                <center>\n                  <v-img class=\"mb-n2\" :src=\"item.photo\" ></v-img>\n                </center>\n              </v-col>\n              <v-col cols=\"3\">\n                <v-progress-circular\n                  :rotate=\"90\"\n                  :size=\"65\"\n                  :width=\"10\"\n                  :value=\"item.percentage\"\n                  color=\"blue\"\n                >\n                  {{ item.percentage }}\n                </v-progress-circular>\n              </v-col>\n              <v-col cols=\"4\">\n                <center>\n                  <v-img class=\"mb-n2\" :src=\"'http://localhost:8001/storage/face_history/' + item.created_at +  '/' + item.unique_id + '.jpg'\"></v-img>\n                </center>\n              </v-col>\n              <p class=\"overline\">{{item.name}} - </p>\n              <p class=\"overline\"> {{item.time}}</p>\n            </v-row>\n          </div>\n        </v-card>\n      </v-col>\n      \n      <v-col\n        cols=\"12\"\n      >\n        <v-card\n          class=\"pa-2 justify-center\"\n          outlined\n          tile\n          \n        >\n          <div v-if=\"face_all.length == 0\">\n            <v-layout justify-center>\n                <v-img src=\"@/assets/no_result.gif\" max-width=\"500\"></v-img>\n            </v-layout>\n          </div>\n          <div v-else>\n            <div class=\"overline\">History Detection</div>\n            <v-divider></v-divider>\n            <v-row class=\"pl-2\">\n              <v-col cols=\"auto\"\n                v-for=\"item in face_all\"\n                :key=\"item.time\" \n              >\n                <v-card max-width=\"160\">\n                  <v-img :src=\"'http://localhost:8001/storage/face_history/' + item.unique_id + '.jpg'\" height=\"200\"></v-img>\n                  <center>\n                      <p>{{ item.name }}</p>\n                      <p class=\"overline mt-n4\">{{ item.time }}</p>\n                  </center>\n                </v-card>\n              </v-col>\n            </v-row>\n            <v-card-actions>\n              <v-spacer></v-spacer>\n                <v-pagination\n                  class=\"pt-2\"\n                  v-model=\"page\"\n                  :length=\"4\"\n                  prev-icon=\"mdi-menu-left\"\n                  next-icon=\"mdi-menu-right\"\n                ></v-pagination>\n              <v-spacer></v-spacer>\n            </v-card-actions>\n          </div>\n        </v-card>\n      </v-col>\n    </v-row>\n</template>\n\n<script>\nimport VueLoadImage from 'vue-load-image'\n\n  export default {\n    components: {'vue-load-image': VueLoadImage },\n    props: {\n      source: String,\n    },\n    data: () => ({\n        alert : false,\n        error_text: '',\n        page: 1,\n        chartHide: false,\n\n        id_camera : '',\n        port: '',\n        camera_list:[],\n        videoDefault: \"@/assets/loading.gif\",\n\n        face_all :[],\n        face_identity :[],\n    }),\n\n    created () {\n      this.$Progress.start()\n      this.id_camera = this.$route.params.id\n      this.initialize()      \n    },\n    \n    mounted(){\n      this.$Progress.finish()\n    },\n\n    watch: {\n        id_camera:function() {\n          this.$socket.emit('join', this.$route.params.id);\n          this.getData(this.$route.params.id)\n        },\n    },\n\n    methods: {\n        async initialize () {\n          const { data } = await this.$http.get(process.env.VUE_APP_IP_SERVER + '/camera')\n          this.camera_list = data\n        },\n\n        async getData(id_camera){\n          try {\n              const { data } = await this.axios.get(process.env.VUE_APP_IP_SERVER + '/camera/' + id_camera)\n              this.port = data['port']\n              this.checkConnection(this.port)\n            } catch (error) {\n                window.console.log(Object.keys(error), error.message);\n            }\n        },\n\n        changeRoute(){\n          this.$socket.emit('leave', this.$route.params.id);\n          this.$router.push({path: '/live/'})\n          this.id_camera = this.$route.params.id\n        },\n\n        checkConnection(port){\n          const _self = this\n          this.axios.get(process.env.VUE_APP_IP_SERVER_WITHOUT_PORT + ':' + port).then(function(){\n            _self.videoStream()\n          }).catch(function(error){\n              if (!error.response) {\n                window.console.log(error)\n                _self.streamStatus = false\n                _self.imageLoadError()\n                _self.text = \"Can't connect video stream !\"\n                _self.color_snackbar = \"red darken-1\"\n              } else {\n                const code = error.response.status\n                const response = error.response.data\n                _self.text = \"Can't connect video stream ! (\" + code + \") response: \" +  response\n                _self.color_snackbar = \"yellow darken-1\"\n              }\n              _self.snackbar = true\n          });\n        },\n\n        videoStream(){\n            let random = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15)\n            this.videoDefault = process.env.VUE_APP_IP_SERVER_WITHOUT_PORT + \":\" + this.port + \"/\" + random + \"/stream.mjpg\"\n        },\n\n        imageLoadError(){\n            this.videoDefault = require('@/assets/offline.jpg')\n        },\n\n    },\n\n    sockets: {\n      connect: function (){\n          window.console.log('socket connected')\n      },\n      face_detect: function (data) {\n          if (this.face_all.length == 12) {\n            this.$delete(this.face_all, 11)\n          }\n          this.face_all.unshift(data)\n\n          if (data.name != \"Unknown\") {\n            this.axios.get('http://localhost:8001/get_face/' + data.nik).then(\n              response => {\n                if (this.face_identity.length == 12) {\n                  this.$delete(this.face_identity, 11)\n                }\n                data.photo = 'data:image/jpeg;base64,' + response.data\n                this.face_identity.unshift(data)\n              }\n            ).catch(error => {\n                window.console.log(error)\n            });\n          }\n      }\n    },\n\n    beforeDestroy: function() {\n        this.$socket.emit('leave', this.$route.params.id);\n    },\n\n  }\n</script>\n"]}]}